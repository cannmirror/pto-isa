<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="720" viewBox="0 0 1200 720" role="img" aria-label="TSYNC tile operation diagram">
<defs>
  <marker id="arrow" markerWidth="12" markerHeight="12" refX="10" refY="6" orient="auto"><path d="M0,0 L0,12 L12,6 z" fill="#A37000"/></marker>
  <marker id="axisArrow" markerWidth="10" markerHeight="10" refX="8" refY="5" orient="auto"><path d="M0,0 L0,10 L10,5 z" fill="#64748b"/></marker>
</defs>
<style>
svg { font-family: Arial, Helvetica, sans-serif; }
.title { font-size: 30px; font-weight: 700; fill: #0f172a; }
.subtitle { font-size: 14px; fill: #334155; }
.meta { font-size: 12px; fill: #64748b; }
.frame { fill: white; }
.panel { fill: #FFF7D6; stroke: #e2e8f0; stroke-width: 1.5; rx: 14; }
.tileLabel { font-size: 14px; font-weight: 700; fill: #0f172a; }
.tileBorder { fill: none; stroke: #475569; stroke-width: 1.5; }
.cell { fill: #ffffff; stroke: #94a3b8; stroke-width: 1; }
.cellMasked { fill: #e2e8f0; }
.cellHL { stroke-width: 2; }
.cellText { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size: 10px; fill: #0f172a; }
.arrow { stroke-width: 2.5; fill: none; stroke-linejoin: round; stroke-linecap: round; }
.axisLine { stroke: #64748b; stroke-width: 1.5; fill: none; }
.axisText { font-size: 10px; fill: #64748b; font-weight: 700; }
.opCircle { fill: #ffffff; stroke-width: 2; }
.opRect { fill: #ffffff; stroke-width: 2; }
.opText { font-size: 10px; font-weight: 800; fill: #0f172a; }
.procBox { fill: #f8fafc; stroke: #cbd5e1; stroke-width: 1.5; rx: 12; }
.procTitle { font-size: 14px; font-weight: 700; fill: #0f172a; }
.procText { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size: 12px; fill: #0f172a; }
.smallLabel { font-size: 12px; fill: #334155; }
.scalarBox { fill: #ffffff; stroke: #cbd5e1; stroke-width: 1.5; }
.scalarValue { font-size: 16px; font-weight: 700; }
.validBox { fill: none; stroke-width: 2; stroke-dasharray: 6 4; }
</style>
<rect x="0" y="0" width="1200" height="720" class="frame" />
<rect x="24" y="24" width="1152" height="672" class="panel" />
<text x="40" y="46" class="title">TSYNC</text>
<text x="40" y="72" class="subtitle">Synchronize PTO execution (wait on events or insert a per-op pipeline barrier).</text>
<text x="40" y="92" class="meta">Template: sync</text>
<text x="1160" y="92" class="meta" text-anchor="end">Legend: outline=example; dashed=valid rows/cols (Rv,Cv); shaded=masked; r down / c right; ortho arrows=dataflow</text>
<line x1="36" y1="104" x2="1164" y2="104" stroke="#e2e8f0" stroke-width="1.5" />
<text x="600" y="140" class="subtitle" text-anchor="middle" fill="#A37000">TSYNC establishes ordering: producer -&gt; consumer</text>
<rect x="340" y="184" width="520" height="92" rx="14" fill="#ffffff" stroke="#A37000" stroke-width="2"/>
<text x="600" y="222" text-anchor="middle" class="tileLabel">Producer stage</text>
<text x="600" y="248" text-anchor="middle" class="smallLabel">ops tagged as producer_class</text>
<rect x="340" y="366" width="520" height="92" rx="14" fill="#ffffff" stroke="#A37000" stroke-width="2"/>
<text x="600" y="404" text-anchor="middle" class="tileLabel">Consumer stage</text>
<text x="600" y="430" text-anchor="middle" class="smallLabel">ops tagged as consumer_class (after TSYNC)</text>
<path d="M 600 276 L 916 276 L 916 366 L 600 366" class="arrow" stroke="#A37000" marker-end="url(#arrow)" />
<rect x="40" y="502" width="1120" height="194" class="procBox" />
<text x="56" y="528" class="procTitle">Procedure (conceptual)</text>
<text x="56" y="554" class="procText" xml:space="preserve">
  <tspan x="56" dy="0">TSYNC(producer_class, consumer_class)</tspan>
  <tspan x="56" dy="16">1) Let P be all earlier ops issued with class=producer_class.</tspan>
  <tspan x="56" dy="16">2) TSYNC waits until P are complete (or until their events are satisfied).</tspan>
  <tspan x="56" dy="16">3) For all later ops with class=consumer_class: observe results of P.</tspan>
  <tspan x="56" dy="16">Ordering: P happens-before consumer_class ops after TSYNC.</tspan>
</text>
<text x="56" y="680" class="meta">Note: semantics apply to the valid region unless stated otherwise.</text>
</svg>
